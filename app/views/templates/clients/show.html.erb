<div id="main" data-ng-controller="ClientsShowCtrl" class="pure-form pure-u">
 <%= render :partial => 'templates/clients/field_modal',
            :locals => {
              :field => {
                :name => 'Generated Documents',
                :id => 'genDocument',
                :required => true,
                :type => [
                  {
                    :name => 'Description',
                    :id => 'description',
                    :placeholder => 'Enter a description here...',
                    :required => true,
                    :type => 'text'
                  },
                  {
                    :name => 'Template',
                    :id => 'template',
                    :placeholder => 'Default',
                    :type => 'dropdown',
                    :options => []
                  },
                  {
                    :name => 'From Change',
                    :id => 'changeDescription',
                    :disabled => true,
                    :type => 'text'
                  }
                ]
              },
              :submit_callback => 'generateDocument()'
            } %>

  <div class="content header pure-u-1">
    <h2 class="no-bottom-margin">
      <i data-ng-show="loading" class="icon-spinner icon-spin"></i>
      <span data-ng-show="!loading">{{ client.name.value }}</span>
    </h2>
    <%= render :partial => 'templates/breadcrumbs',
               :locals => { :paths => {
          "Home" => "#/",
          "Clients" => "#/clients/",
          "{{ client.name.value }}" => "#/clients/show/{{ clientId }}",
        }}
     %>
  </div>
  <hr class="soften" />

  <div class="content client-show">
    <div class="client-info pure-form pure-form-aligned well">
      <div class="section" id="basicInfo">
        <div class="client-buttons pull-right">
          <a class="pure-button pure-button-primary"
             data-ng-href="#/clients/edit/{{ clientId }}">
            <i class="icon-edit"></i><span class="desc"><span class="only-desktops"> View and</span> Edit</span>
          </a>
        </div>
        <h3 class="no-top-margin">Client Info.</h3>
      </div>

      <div data-ng-show="loading">
        <h3 class="no-top-margin"><i class="icon-spinner icon-spin icon-large"></i> Loading...</h3>
      </div>
      <div data-ng-show="!loading">
        <div class="pure-control-group">
          <label for="name">Name</label>
          <span class="value">{{ client.name.value }}</span>
        </div>
        <div class="pure-control-group">
          <label for="address">Address</label>
          <span class="value">{{ client.address.value }}</span>
        </div>
        <div class="pure-control-group">
          <label for="city_and_province">City and Province</label>
          <span class="value">{{ client.cityAndProvince.value }}</span>
        </div>
        <div class="pure-control-group">
          <label for="phone">Phone</label>
          <span class="value">{{ client.phone.value }}</span>
        </div>
      </div>
    </div>

    <div class="client-docs well">
      <div class="section" id="basicInfo">
        <h3 class="no-top-margin">Edit History</h3>
      </div>
      <%= render :partial => 'templates/clients/edit_history_table' %>
    </div>

    <div class="client-docs well">
      <div class="section" id="basicInfo">
        <h3 class="no-top-margin">Documents</h3>
      </div>
      <table class="document-table pure-table pure-table-horizontal pure-table-full-width">
        <thead>
          <tr>
            <th class="name">Description</th>
            <th class="actions align-right">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr data-ng-show="docLoading">
            <td colspan="2"><i class="icon-spinner icon-spin icon-large"></i> Loading...</td>
          </tr>
          <tr data-ng-show="!docLoading && docError">
            <td colspan="2">Must be online to view and generate documents.</td>
          </tr>
          <tr data-ng-show="!docLoading && !docError && !documents.length">
            <td colspan="2">No documents generated for this client yet.</td>
          </tr>
          <tr data-ng-show="generating">
            <td colspan="2"><i class="icon-spinner icon-spin icon-large"></i> Generating new document...</td>
          </tr>
          <tr data-ng-repeat="document in documents">
            <td class="description">
              {{ document.description }}
              <div class="detail">
                Created by <span class="email">{{ document.user_email }}</span><span class="except-desktops"><br /></span>
                on <span class="date">{{ document.created_at | date: 'medium'}}</span>
              </div>
            </td>
            <td class="actions align-right">
              <a data-ng-href="/api/documents/{{ document.id }}" class="pure-button pure-button-small pure-button-success">
                <i class="icon-download-alt icon-large"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
